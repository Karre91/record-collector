@using Krompaco.RecordCollector.Web.Extensions
@model LayoutViewModel
<!DOCTYPE html>
<html lang="@Model.CurrentCulture.Name">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>@Model.Title</title>
	<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
	<link rel="shortcut icon" href="/favicon.ico" type="image/ico" />
	@if (!string.IsNullOrWhiteSpace(Model.Robots))
	{
		<meta name="robots" content="@Model.Robots" />
	}
	<meta name="description" content="@Model.Description" />
	@if (!string.IsNullOrWhiteSpace(Model.Keywords))
	{
		<meta name="keywords" content="@Model.Keywords" />
	}
	@await RenderSectionAsync("head", false)
</head>
<body>
	@if (Model.RootCultures.Count > 0 && Model.CurrentPath != "/"
		 || Model.NavigationItems.Count > 0)
	{
		<div id="skip">
			<a href="#main">@Model.Localizer["Skip to main content"]</a>
		</div>
		<div role="navigation">
			@if (Model.NavigationItems.Count > 0)
			{
				<ul>
					@if (Model.CurrentPath == "/" || Model.RootCultures.Count > 0 && Model.CurrentCulture.Name == Model.CurrentPath.Replace("/", string.Empty))
					{
						<li>@Model.Localizer["Home"]</li>
					}
					else
					{
						<li><a href="@(Model.RootCultures.Count > 0 ? $"/{Model.CurrentCulture.Name}/" : "/")">@Model.Localizer["Home"]</a></li>
					}

					@foreach (var ni in Model.NavigationItems)
					{
						<li>
							@if (ni.IsSelected)
							{
								@ni.Text
							}
							else
							{
								<a href="@ni.RelativeUrl">@ni.Text</a>
							}

							@if (ni.HasChildren)
							{
								NavigationList(ni.ChildItems);
							}
						</li>
					}
				</ul>
			}
		</div>
	}

	<div role="main" id="main">
		@RenderBody()
	</div>

<div role="contentinfo" class="footer">
	@if (Model.RootCultures.Count > 0 && Model.CurrentPath != "/")
	{
		<h2>@Model.Localizer["Change language"]</h2>
		<ul>
			@foreach (var c in Model.RootCultures)
			{
				<li>
					@if (Model.CurrentPath != "/" && c.Equals(Model.CurrentCulture))
					{
						@c.NativeName.FirstCharToUpper()
					}
					else
					{
						<a lang="@c.Name" href="/@c.Name.ToLower(Model.CurrentCulture)/">@c.NativeName.FirstCharToUpper()</a>
					}
				</li>
			}
		</ul>
	}

	@Model.Localizer["Generated by"] <a href="https://record-collector.net/">Record Collector</a>
</div>

</body>
</html>

@functions {
	void NavigationList(List<MenuItemViewModel> listItems)
	{
		<ul>
			@foreach (var ni in listItems)
			{
				<li>
					@if (ni.IsSelected)
					{
						@ni.Text
					}
					else
					{
						<a href="@ni.RelativeUrl">@ni.Text</a>
					}

					@if (ni.HasChildren)
					{
						NavigationList(ni.ChildItems);
					}
				</li>
			}
		</ul>
	}
}
